import{a as $,d as L}from"./chunk-BGZLXYWZ.js";import{i as z,m as q,n as Q}from"./chunk-DR26E5HF.js";import{$b as f,C as A,Ea as F,Ib as O,Kb as g,Lb as C,Lc as w,Mc as N,Ob as m,Pb as h,Qb as b,Xb as k,Yb as V,Z as _,_b as E,ab as I,bb as r,ca as R,cc as S,dc as B,ec as x,fc as v,gb as y,ha as p,lc as j,oa as T,oc as H,pa as P,tb as D,xa as u,yb as M}from"./chunk-DCDCP4BO.js";import{a as d,b as c}from"./chunk-GAL4ENT6.js";var K=["modalHeader"],Z=["modalBody"],U=["modalFooter"],G=["modalDialog"];function J(i,n){i&1&&k(0)}function W(i,n){if(i&1){let s=V();h(0,"button",9),E("click",function(){T(s);let t=f(3);return P(t.close())}),h(1,"span",10),H(2,"\xD7"),b()()}if(i&2){let s=f(3);O("aria-label",s.getCloseButtonLabel())}}function X(i,n){if(i&1&&(h(0,"div",4),M(1,J,1,0,"ng-container",7),g(2,W,3,1,"button",8),b()),i&2){let s=f(2);r(),m("ngTemplateOutlet",s.header),r(),C(s.shouldHideCloseButton()?-1:2)}}function Y(i,n){i&1&&k(0)}function ee(i,n){if(i&1&&(h(0,"div",5),M(1,Y,1,0,"ng-container",7),b()),i&2){let s=f(2);m("id",s.descriptionId()),r(),m("ngTemplateOutlet",s.body)}}function te(i,n){i&1&&k(0)}function oe(i,n){if(i&1&&(h(0,"div",6),M(1,te,1,0,"ng-container",7),b()),i&2){let s=f(2);r(),m("ngTemplateOutlet",s.footer)}}function ie(i,n){if(i&1&&(h(0,"div",1)(1,"div",2)(2,"div",3),g(3,X,3,2,"div",4),g(4,ee,2,2,"div",5),g(5,oe,2,1,"div",6),b()()()),i&2){let s=f();j("in",s.visibleAnimate()),m("ngClass",s.getCustomClass()),O("aria-modal",!0)("aria-labelledby",s.titleId())("aria-describedby",s.descriptionId()),r(),m("ngClass",s.getDialogClasses()),r(2),C(s.header||s.hasHeaderContent()?3:-1),r(),C(s.body?4:-1),r(),C(s.footer||s.hasFooterContent()?5:-1)}}var ne=(()=>{let n=class n{constructor(){this.modals=u([]),this.baseZIndex=1050}register(e){this.modals.update(t=>[...t,e])}unregister(e){this.modals.update(t=>t.filter(o=>o!==e))}isTopMost(e){let o=this.modals().filter(a=>a.visible());return o[o.length-1]===e}getNextZIndex(){let e=this.modals().filter(t=>t.visible()).length;return this.baseZIndex+e*10}getActiveModalsCount(){return this.modals().filter(e=>e.visible()).length}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=R({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})(),se=(()=>{let n=class n{constructor(){this.majorVersion=parseInt(_.major),this.minorVersion=parseInt(_.minor)}afterEveryRender(e,t){try{if(this.majorVersion>=20){let o=globalThis?.ng?.core?.afterEveryRender;if(o)return o(e,t)}else if(this.majorVersion>=17||this.majorVersion===16&&this.minorVersion>=2){let o=globalThis?.ng?.core?.afterRender;if(o)return o(e,t)}}catch(o){console.warn("Error executing lifecycle hook:",o)}return this.fallbackAfterRender(e),null}afterNextRender(e,t){try{let o=globalThis?.ng?.core?.afterNextRender;if(o)return o(e,t)}catch(o){console.warn("Error executing afterNextRender hook:",o)}return this.fallbackAfterNextRender(e),null}fallbackAfterRender(e){typeof requestAnimationFrame<"u"?requestAnimationFrame(()=>{try{e()}catch(t){console.warn("Error in fallback afterRender callback:",t)}}):setTimeout(()=>{try{e()}catch(t){console.warn("Error in fallback afterRender callback:",t)}},0)}fallbackAfterNextRender(e){this.fallbackAfterRender(e)}getVersionInfo(){return{major:this.majorVersion,minor:this.minorVersion,patch:_.patch,hasAfterRender:!0,hasAfterNextRender:!0,hookName:this.majorVersion>=20?"afterEveryRender":"afterRender"}}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=R({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})(),xe=(()=>{let n=class n{constructor(){this.elementRef=p(F),this.document=p(Document,{optional:!0}),this.lifecycleService=p(se),this.router=p(L,{optional:!0}),this.header=null,this.body=null,this.footer=null,this.closeOnOutsideClick=!0,this.closeOnEscape=!0,this.hideCloseButton=!1,this.options={},this.size="md",this.centered=!1,this.scrollable=!1,this.animation=!0,this.backdrop="dynamic",this.keyboard=!0,this.focus=!0,this.closeOnRouteChange=!0,this.opened=new y,this.closed=new y,this.opening=new y,this.closing=new y,this.modalState=u({isVisible:!1,isAnimating:!1,zIndex:1050,previousFocusedElement:void 0}),this.animationDuration=u(200),this.modalStack=u([]),this.visible=w(()=>this.modalState().isVisible),this.visibleAnimate=u(!1),this.isAnimating=w(()=>this.modalState().isAnimating),this.titleId=u(`modal-title-${Math.random().toString(36).substr(2,9)}`),this.descriptionId=u(`modal-desc-${Math.random().toString(36).substr(2,9)}`),this.previouslyFocusedElement=null,this.modalStackService=p(ne,{optional:!0}),this.afterRenderCleanup=null,this.afterNextRenderCleanup=null,N(()=>{this.visible()?this.handleModalOpen():this.handleModalClose()}),N(()=>{let e=this.options.animationDuration||200;this.animationDuration.set(e),this.updateCSSAnimationDuration(e)}),this.setupLifecycleHooks()}ngOnInit(){this.registerInModalStack(),this.logVersionInfo(),this.setupRouteChangeSubscription()}ngOnDestroy(){this.close(),this.unregisterFromModalStack(),this.restoreFocus(),this.removeBodyClass(),this.cleanupLifecycleHooks(),this.cleanupRouteSubscription()}open(){this.visible()||(this.opening.emit(),this.storePreviousFocus(),this.addBodyClass(),this.modalState.update(e=>c(d({},e),{isVisible:!0,isAnimating:!0})),this.animation?setTimeout(()=>{this.visibleAnimate.set(!0),this.modalState.update(e=>c(d({},e),{isAnimating:!1})),this.focusFirstElement(),this.opened.emit()},10):(this.visibleAnimate.set(!0),this.modalState.update(e=>c(d({},e),{isAnimating:!1})),this.focusFirstElement(),this.opened.emit()))}close(){if(!this.visible())return;this.closing.emit(),this.modalState.update(t=>c(d({},t),{isAnimating:!0})),this.visibleAnimate.set(!1);let e=this.animation?this.animationDuration():0;setTimeout(()=>{this.modalState.update(t=>c(d({},t),{isVisible:!1,isAnimating:!1})),this.removeBodyClass(),this.restoreFocus(),this.closed.emit()},e)}toggle(){this.visible()?this.close():this.open()}onContainerClicked(e){let t=this.options.closeOnOutsideClick??this.closeOnOutsideClick,o=this.options.backdrop||this.backdrop;e.target.classList.contains("modal")&&this.isTopMost()&&t&&o==="dynamic"&&this.close()}onKeyDownHandler(e){if(!this.visible()||!this.isTopMost())return;let t=this.options.closeOnEscape??this.closeOnEscape,o=this.options.keyboard??this.keyboard;e.key==="Escape"&&t&&o?this.close():e.key==="Tab"&&this.handleTabKey(e)}isTopMost(){return this.modalStackService?this.modalStackService.isTopMost(this):!this.elementRef.nativeElement.querySelector(":scope ngx-custom-modal > .modal")}getCustomClass(){let e=this.customClass??this.options.customClass??"",t=this.getSizeClass(),o=this.getAnimationClass();return[e,t,o].filter(Boolean).join(" ")}getDialogClasses(){let e=[];(this.centered||this.options.centered)&&e.push("modal-dialog-centered"),(this.scrollable||this.options.scrollable)&&e.push("modal-dialog-scrollable");let t=this.options.size||this.size;return t&&t!=="md"&&e.push(`modal-${t}`),e.join(" ")}shouldHideCloseButton(){return this.hideCloseButton||this.options.hideCloseButton||!1}getCloseButtonLabel(){return"Close modal"}hasHeaderContent(){return!!this.header}hasFooterContent(){return!!this.footer}setupRouteChangeSubscription(){if(!this.router)return;(this.options.closeOnRouteChange??this.closeOnRouteChange)&&(this.routerSubscription=this.router.events.pipe(A(t=>t instanceof $)).subscribe(()=>{this.visible()&&this.close()}))}cleanupRouteSubscription(){this.routerSubscription&&(this.routerSubscription.unsubscribe(),this.routerSubscription=void 0)}setupLifecycleHooks(){this.afterNextRenderCleanup=this.lifecycleService.afterNextRender(()=>{this.setupAccessibility(),this.setupKeyboardNavigation(),this.setupFocusManagement()}),this.afterRenderCleanup=this.lifecycleService.afterEveryRender(()=>{this.visible()&&this.modalDialog&&(this.adjustModalPosition(),this.ensureProperZIndex())})}cleanupLifecycleHooks(){this.afterRenderCleanup&&(this.afterRenderCleanup(),this.afterRenderCleanup=null),this.afterNextRenderCleanup&&(this.afterNextRenderCleanup(),this.afterNextRenderCleanup=null)}logVersionInfo(){let e=this.lifecycleService.getVersionInfo();console.log(`[NgxCustomModal] Angular ${e.major}.${e.minor}.${e.patch}`),console.log(`[NgxCustomModal] Using lifecycle hook: ${e.hookName}`),console.log(`[NgxCustomModal] Hooks available - afterRender: ${e.hasAfterRender}, afterNextRender: ${e.hasAfterNextRender}`)}handleModalOpen(){this.previouslyFocusedElement=this.document?.activeElement,this.announceToScreenReader("Modal opened")}handleModalClose(){this.announceToScreenReader("Modal closed")}setupAccessibility(){let e=this.elementRef.nativeElement.querySelector(".modal");e&&(e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"))}setupKeyboardNavigation(){}setupFocusManagement(){}adjustModalPosition(){let e=this.elementRef.nativeElement.querySelector(".modal-dialog");e&&e.getBoundingClientRect().height>window.innerHeight*.9&&(e.style.height=`${window.innerHeight*.9}px`)}ensureProperZIndex(){let e=this.elementRef.nativeElement.querySelector(".modal");if(e&&this.modalStackService){let t=this.modalStackService.getNextZIndex();e.style.zIndex=t.toString(),this.modalState.update(o=>c(d({},o),{zIndex:t}))}}storePreviousFocus(){this.previouslyFocusedElement=this.document?.activeElement,this.modalState.update(e=>c(d({},e),{previousFocusedElement:this.previouslyFocusedElement||void 0}))}restoreFocus(){this.previouslyFocusedElement&&this.focus&&setTimeout(()=>{this.previouslyFocusedElement?.focus()},0)}focusFirstElement(){this.focus&&setTimeout(()=>{let e=this.elementRef.nativeElement.querySelector(".modal"),t=e?.querySelector('button:not([disabled]), input:not([disabled]), textarea:not([disabled]), select:not([disabled]), a[href], [tabindex]:not([tabindex="-1"])');t?t.focus():e?.querySelector(".close")?.focus()},0)}handleTabKey(e){let t=this.elementRef.nativeElement.querySelector(".modal");if(!t)return;let o=Array.from(t.querySelectorAll('button:not([disabled]), input:not([disabled]), textarea:not([disabled]), select:not([disabled]), a[href], [tabindex]:not([tabindex="-1"])')),a=o[0],l=o[o.length-1];e.shiftKey?this.document?.activeElement===a&&(e.preventDefault(),l?.focus()):this.document?.activeElement===l&&(e.preventDefault(),a?.focus())}addBodyClass(){this.document?.body.classList.add("modal-open")}removeBodyClass(){this.modalStackService?.getActiveModalsCount()===0&&this.document?.body.classList.remove("modal-open")}getSizeClass(){let e=this.options.size||this.size;return e&&e!=="md"?`modal-${e}`:""}getAnimationClass(){return this.options.animation??this.animation?"modal-animated":"modal-no-animation"}updateCSSAnimationDuration(e){let t=this.elementRef.nativeElement.querySelector(".modal");t&&t.style.setProperty("--modal-animation-duration",`${e}ms`)}registerInModalStack(){this.modalStackService?.register(this)}unregisterFromModalStack(){this.modalStackService?.unregister(this)}announceToScreenReader(e){let t=this.document?.createElement("div");t&&(t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only visually-hidden",t.style.position="absolute",t.style.left="-10000px",t.style.width="1px",t.style.height="1px",t.style.overflow="hidden",t.textContent=e,this.document?.body.appendChild(t),setTimeout(()=>{this.document?.body.removeChild(t)},1e3))}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=D({type:n,selectors:[["ngx-custom-modal"]],contentQueries:function(t,o,a){if(t&1&&(S(a,K,5),S(a,Z,5),S(a,U,5)),t&2){let l;x(l=v())&&(o.header=l.first),x(l=v())&&(o.body=l.first),x(l=v())&&(o.footer=l.first)}},viewQuery:function(t,o){if(t&1&&B(G,5),t&2){let a;x(a=v())&&(o.modalDialog=a.first)}},hostBindings:function(t,o){t&1&&E("click",function(l){return o.onContainerClicked(l)})("keydown",function(l){return o.onKeyDownHandler(l)},I)},inputs:{closeOnOutsideClick:"closeOnOutsideClick",closeOnEscape:"closeOnEscape",customClass:"customClass",hideCloseButton:"hideCloseButton",options:"options",size:"size",centered:"centered",scrollable:"scrollable",animation:"animation",backdrop:"backdrop",keyboard:"keyboard",focus:"focus",closeOnRouteChange:"closeOnRouteChange"},outputs:{opened:"opened",closed:"closed",opening:"opening",closing:"closing"},decls:1,vars:1,consts:[["role","dialog","tabindex","-1",1,"modal","fade",3,"in","ngClass"],["role","dialog","tabindex","-1",1,"modal","fade",3,"ngClass"],[1,"modal-dialog",3,"ngClass"],[1,"modal-content"],[1,"modal-header"],[1,"modal-body",3,"id"],[1,"modal-footer"],[4,"ngTemplateOutlet"],["type","button",1,"close"],["type","button",1,"close",3,"click"],["aria-hidden","true"]],template:function(t,o){t&1&&g(0,ie,6,10,"div",0),t&2&&C(o.visible()?0:-1)},dependencies:[Q,z,q],styles:["[_nghost-%COMP%]{display:contents}[_nghost-%COMP%]     .modal{position:fixed;top:0;left:0;width:100%;min-height:100%;background-color:#00000026;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);display:flex;align-items:center;justify-content:center;z-index:1050;opacity:0;transition:opacity var(--modal-animation-duration, .2s) ease-in-out}[_nghost-%COMP%]     .modal.in{opacity:1}[_nghost-%COMP%]     .modal-dialog{position:relative;width:auto;margin:.5rem;pointer-events:none;transform:scale(.9);transition:transform var(--modal-animation-duration, .2s) ease-in-out}[_nghost-%COMP%]     .modal.in .modal-dialog{transform:scale(1)}[_nghost-%COMP%]     .modal-content{position:relative;display:flex;flex-direction:column;width:100%;pointer-events:auto;background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,.125);border-radius:.5rem;box-shadow:0 .5rem 1rem #00000026;outline:0}[_nghost-%COMP%]     .modal-header{display:flex;flex-shrink:0;align-items:center;justify-content:space-between;padding:1rem;border-bottom:1px solid #dee2e6;border-top-left-radius:calc(.5rem - 1px);border-top-right-radius:calc(.5rem - 1px)}[_nghost-%COMP%]     .modal-body{position:relative;flex:1 1 auto;padding:1rem}[_nghost-%COMP%]     .modal-footer{display:flex;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;padding:.75rem;border-top:1px solid #dee2e6;border-bottom-right-radius:calc(.5rem - 1px);border-bottom-left-radius:calc(.5rem - 1px)}[_nghost-%COMP%]     .close{padding:.25rem;margin:-.25rem -.25rem -.25rem auto;background:transparent;border:0;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:.5;cursor:pointer;transition:opacity .15s ease-in-out}[_nghost-%COMP%]     .close:hover{color:#000;text-decoration:none;opacity:.75}[_nghost-%COMP%]     .close:focus{outline:0;box-shadow:0 0 0 .25rem #0d6efd40;opacity:1}[_nghost-%COMP%]     .modal-dialog-centered{display:flex;align-items:center;min-height:calc(100% - 1rem)}[_nghost-%COMP%]     .modal-dialog-scrollable{height:calc(100% - 1rem)}[_nghost-%COMP%]     .modal-dialog-scrollable .modal-content{max-height:100%;overflow:hidden}[_nghost-%COMP%]     .modal-dialog-scrollable .modal-body{overflow-y:auto}[_nghost-%COMP%]     .modal-sm{max-width:300px}[_nghost-%COMP%]     .modal-lg{max-width:800px}[_nghost-%COMP%]     .modal-xl{max-width:1140px}@media (prefers-reduced-motion: reduce){[_nghost-%COMP%]     .modal{transition:none}[_nghost-%COMP%]     .modal-dialog{transition:none}}@media (prefers-color-scheme: dark){[_nghost-%COMP%]     .modal{background-color:#000c}[_nghost-%COMP%]     .modal-content{background-color:#1f2937;color:#f9fafb;border-color:#374151}[_nghost-%COMP%]     .modal-header, [_nghost-%COMP%]     .modal-footer{border-color:#374151}[_nghost-%COMP%]     .close{color:#f9fafb;text-shadow:0 1px 0 #000}}"],changeDetection:0});let i=n;return i})();export{xe as a};
