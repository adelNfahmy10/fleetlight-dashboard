import{Ea as f,Vc as p,da as m,kb as c,nb as a,ob as n,qb as u,ub as v,vb as l}from"./chunk-DCDCP4BO.js";var b=1,h=()=>b++;var d=(()=>{class i{constructor(e,t){this.renderer=e,this.changeDetection=t,this.static=!1,this.expanded=!1,this.menuItems=[],this.activeItem=null,this.searchQuery="",this.searchDebounce=null}toggle(e=null,t=!0){this.expanded?(this.expanded=!1,this.menuItemsPanel.collapse(),this.menuButton.element.removeAttribute("aria-controls"),this.menuButton.element.removeAttribute("expanded"),this.menuItems=[],this.activeItem=null,this.windowClickUnlisten(),t&&this.menuButton.focus(),this.changeDetection.markForCheck()):(this.expanded=!0,this.changeDetection.markForCheck(),setTimeout(()=>{this.menuItemsPanel.expand(),this.menuItemsPanel.focus(),this.menuItemsPanel.element!=null&&this.menuButton.element.setAttribute("aria-controls",this.menuItemsPanel.element.id),this.menuButton.element.setAttribute("expanded","true"),this.windowClickUnlisten=this.initListeners(),e&&setTimeout(()=>this.focusItem(e))}))}focusItem(e){let t=this.calculateFocusedItem(e);t!==this.activeItem&&(this.activeItem=t,this.menuItems.forEach(s=>{this.activeItem?this.menuItemsPanel.element?.setAttribute("aria-activedescendant",this.activeItem.element.id):this.menuItemsPanel.element?.removeAttribute("aria-activedescendant"),s.setActive(s===this.activeItem)}))}clickActive(){this.activeItem?.element.click()}search(e){this.searchDebounce&&clearTimeout(this.searchDebounce),this.searchDebounce=setTimeout(()=>this.searchQuery="",350),this.searchQuery+=e.toLocaleLowerCase();let t=this.menuItems.find(s=>s.element.textContent?.trim().toLocaleLowerCase()?.startsWith(this.searchQuery)&&!s.hlMenuItemDisabled);t===void 0||t===this.activeItem||this.focusItem({kind:"FocusSpecific",item:t})}calculateFocusedItem(e){let t=this.menuItems.filter(s=>!s.hlMenuItemDisabled);switch(e.kind){case"FocusSpecific":return e.item;case"FocusNothing":return null;case"FocusFirst":return t[0];case"FocusLast":return t[t.length-1];case"FocusNext":if(this.activeItem===null)return t[0];{let s=Math.min(t.indexOf(this.activeItem)+1,t.length-1);return t[s]}case"FocusPrevious":if(this.activeItem===null)return t[t.length-1];{let s=Math.max(t.indexOf(this.activeItem)-1,0);return t[s]}}}initListeners(){return this.renderer.listen(window,"click",e=>{let t=e.target,s=document.activeElement;if(this.menuButton.element.contains(t)||this.menuItemsPanel?.element?.contains(t))return;let o=s!==document.body&&s?.contains(t);this.toggle(null,!o)})}}return i.\u0275fac=function(e){return new(e||i)(n(a),n(p))},i.\u0275dir=l({type:i,selectors:[["","hlMenu",""]],inputs:{static:"static"},exportAs:["hlMenu"],standalone:!1}),i})(),D=(()=>{class i{constructor(e,t,s){this.menu=t,this.renderer=s,this.element=e.nativeElement,t.menuButton=this}ngOnInit(){this.initAttributes(this.element),this.renderer.listen(this.element,"click",()=>{this.menu.toggle()}),this.renderer.listen(this.element,"keydown",e=>{switch(e.key){case" ":case"Enter":case"ArrowDown":e.preventDefault(),this.menu.toggle({kind:"FocusFirst"});break;case"ArrowUp":e.preventDefault(),this.menu.toggle({kind:"FocusLast"});break}})}focus(){setTimeout(()=>this.element?.focus())}initAttributes(e){e.id=`headlessui-menu-button-${h()}`,e.setAttribute("type","button"),e.setAttribute("aria-haspopup","true")}}return i.\u0275fac=function(e){return new(e||i)(n(f),n(d),n(a))},i.\u0275dir=l({type:i,selectors:[["","hlMenuButton",""]],standalone:!1}),i})(),I=(()=>{class i{constructor(e,t,s,o){this.templateRef=e,this.viewContainerRef=t,this.menu=s,this.renderer=o,this.element=null,this.menu.menuItemsPanel=this}ngOnInit(){this.menu.static&&this.expandInternal()}expand(){this.menu.static||this.expandInternal()}collapse(){this.menu.static||(this.viewContainerRef.clear(),this.element=null)}focus(){this.element?.focus({preventScroll:!0})}expandInternal(){let e=this.viewContainerRef.createEmbeddedView(this.templateRef),t=e.rootNodes[0];this.initAttributes(t),this.initListeners(t),this.element=t,e.markForCheck()}initAttributes(e){e.tabIndex=-1,e.id=`headlessui-menu-items-${h()}`,e.setAttribute("role","menu"),e.setAttribute("aria-labelledby",this.menu.menuButton.element.id)}initListeners(e){this.renderer.listen(e,"keydown",t=>{switch(t.key){case" ":this.menu.searchQuery!==""?(t.preventDefault(),this.menu.search(t.key)):(t.preventDefault(),this.menu.clickActive());break;case"Enter":t.preventDefault(),this.menu.clickActive();break;case"ArrowDown":t.preventDefault(),this.menu.focusItem({kind:"FocusNext"});break;case"ArrowUp":t.preventDefault(),this.menu.focusItem({kind:"FocusPrevious"});break;case"Home":case"PageUp":t.preventDefault(),this.menu.focusItem({kind:"FocusFirst"});break;case"End":case"PageDown":t.preventDefault(),this.menu.focusItem({kind:"FocusLast"});break;case"Escape":t.preventDefault(),this.menu.toggle();break;case"Tab":t.preventDefault();break;default:t.key.length===1&&this.menu.search(t.key)}})}}return i.\u0275fac=function(e){return new(e||i)(n(c),n(u),n(d),n(a))},i.\u0275dir=l({type:i,selectors:[["","hlMenuItems",""]],standalone:!1}),i})(),g=(()=>{class i{constructor(e,t,s,o){this.templateRef=e,this.viewContainerRef=t,this.menu=s,this.renderer=o,this.hlMenuItemDisabled=!1,this.context={active:!1},this.menu.menuItems.push(this)}ngOnInit(){this.view=this.viewContainerRef.createEmbeddedView(this.templateRef,{$implicit:this.context}),this.element=this.view.rootNodes[0],this.initAttributes(this.element),this.initListeners(this.element)}setActive(e){this.context.active=e,this.view.markForCheck()}initAttributes(e){e.id=`headlessui-menu-item-${h()}`,e.tabIndex=-1,e.setAttribute("role","menuitem"),this.hlMenuItemDisabled?this.element.setAttribute("aria-disabled","true"):this.element.removeAttribute("aria-disabled")}initListeners(e){this.renderer.listen(e,"pointermove",()=>this.menu.focusItem({kind:"FocusSpecific",item:this})),this.renderer.listen(e,"pointerleave",()=>this.menu.focusItem({kind:"FocusNothing"})),this.renderer.listen(e,"click",t=>{if(this.hlMenuItemDisabled){t.preventDefault();return}this.menu.toggle()})}}return i.\u0275fac=function(e){return new(e||i)(n(c),n(u),n(d),n(a))},i.\u0275dir=l({type:i,selectors:[["","hlMenuItem",""]],inputs:{hlMenuItemDisabled:"hlMenuItemDisabled"},standalone:!1}),i})(),k=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=v({type:i}),i.\u0275inj=m({providers:[],imports:[[]]}),i})();export{d as a,D as b,I as c,g as d,k as e};
